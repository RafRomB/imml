
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_tutorials/generate_missing_modalities.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_tutorials_generate_missing_modalities.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_tutorials_generate_missing_modalities.py:


==================================================
Modality-wise missing data simulation (Amputation)
==================================================

Evaluation and benchmarking of new algorithms under diverse conditions is essential to ensure their robustness,
added value and generalizability. `iMML` simplifies this process by simulating incomplete multi-modal datasets with
block-wise missing data. This so-called data amputation process allows for controlled testing of methods by
introducing missing data from various mechanisms that reflect real-world scenarios where different modalities may be
partially observed or entirely missing.

What you will learn:

- The four amputation (missingness) mechanisms supported by iMML (PM, MCAR, MNAR, MEM).
- How to generate modality-wise incomplete multi-modal datasets with Amputer.
- How to visualize missingness patterns across modalities.
- How missingness mechanisms and rates affect per-modality data availability.

Missingness mechanisms:

- Partial missing (PM): some modalities are fully observed for all samples, while others are partially missing at random.
- Missing completely at random (MCAR): missing modalities occur randomly across samples.
- Missing not at random (MNAR): certain samples are missing in specific modalities due to factors that influence missingness.
- Mutually exclusive missing (MEM): incomplete samples have only one observed modality (an extreme case of MNAR).

This tutorial is fully reproducible and uses a small synthetic dataset. You can easily
replace the data-loading section with your own data following the same structure.

.. GENERATED FROM PYTHON SOURCE LINES 29-34

.. code-block:: Python


    # sphinx_gallery_thumbnail_number = 1

    # License: BSD 3-Clause License








.. GENERATED FROM PYTHON SOURCE LINES 35-37

Step 1: Import required libraries
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 37-47

.. code-block:: Python


    import numpy as np
    import matplotlib.pyplot as plt
    import pandas as pd
    from IPython.core.display_functions import display

    from imml.ampute import Amputer
    from imml.explore import get_summary
    from imml.visualize import plot_missing_modality








.. GENERATED FROM PYTHON SOURCE LINES 48-57

Step 2: Load the dataset
^^^^^^^^^^^^^^^^^^^^^^^^
For illustration, we create a small random multi-modal dataset with 10 samples and 4 modalities.

Using your own data:

- Represent your dataset as a Python list Xs, one entry per modality.
- Each Xs[i] should be a 2D array-like (pandas DataFrame or NumPy array) of shape (n_samples, n_features_i).
- All modalities must refer to the same samples and be aligned by row order or index.

.. GENERATED FROM PYTHON SOURCE LINES 57-64

.. code-block:: Python


    random_state = 7
    n_mods = 4
    n_samples = 10
    Xs = [pd.DataFrame(np.random.default_rng(random_state).random((n_samples, 10))) for i in range(n_mods)]









.. GENERATED FROM PYTHON SOURCE LINES 65-69

Step 3: Simulate missing data
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Using ``Amputer``, we introduce missing data to simulate a scenario where some modalities are missing. Here,
80% of the samples will be incomplete following a mutually exclusive missing pattern.

.. GENERATED FROM PYTHON SOURCE LINES 69-74

.. code-block:: Python


    mechanism = "mem"
    transformed_Xs = Amputer(mechanism=mechanism, p=0.8, random_state=random_state).fit_transform(Xs)









.. GENERATED FROM PYTHON SOURCE LINES 75-77

We can visualize which modalities are missing using a binary color map (black = observed, white = missing).
Each row is a sample; each column is a modality.

.. GENERATED FROM PYTHON SOURCE LINES 77-80

.. code-block:: Python

    _ = plot_missing_modality(Xs=transformed_Xs, figsize= (3.18,2.2))





.. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_001.png
   :alt: generate missing modalities
   :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 81-85

Step 4: Compare amputation mechanisms
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
We now illustrate the four different amputation patterns: mutually exclusive missing (MEM),
partial missing (PM), missing completely at random (MCAR), and missing not at random (MNAR).

.. GENERATED FROM PYTHON SOURCE LINES 85-104

.. code-block:: Python


    mechanism_dict = {"mem": "Mutually exclusive missing",
                      "pm": "Partial missing",
                      "mcar": "Missing completely at random",
                      "mnar": "Missing not at random",
                      }


    samples_dict = {}
    fig,axs = plt.subplots(1,4, figsize= (12.5,2.5))
    for idx, (ax, mechanism) in enumerate(zip(axs, list(mechanism_dict.keys()))):
        transformed_Xs = Amputer(mechanism=mechanism, p=0.8, random_state=random_state).fit_transform(Xs)
        fig, ax = plot_missing_modality(Xs=transformed_Xs, ax=ax)
        if idx != 0:
            ax.get_yaxis().set_visible(False)
        samples_dict[mechanism_dict[mechanism]] = get_summary(Xs=transformed_Xs, one_row=True)
    plt.tight_layout()





.. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_002.png
   :alt: generate missing modalities
   :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 105-107

As shown in the table below, all cases have the same numbers of complete and incomplete samples overall.
However, the number of observed samples in each modality varies with the missingness mechanism.

.. GENERATED FROM PYTHON SOURCE LINES 107-110

.. code-block:: Python


    pd.DataFrame.from_dict(samples_dict, orient= "index")






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Complete samples</th>
          <th>Incomplete samples</th>
          <th>Observed samples per modality</th>
          <th>Missing samples per modality</th>
          <th>% Observed samples per modality</th>
          <th>% Missing samples per modality</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Mutually exclusive missing</th>
          <td>2</td>
          <td>8</td>
          <td>[4, 4, 4, 4]</td>
          <td>[6, 6, 6, 6]</td>
          <td>[40, 40, 40, 40]</td>
          <td>[60, 60, 60, 60]</td>
        </tr>
        <tr>
          <th>Partial missing</th>
          <td>2</td>
          <td>8</td>
          <td>[4, 6, 7, 10]</td>
          <td>[6, 4, 3, 0]</td>
          <td>[40, 60, 70, 100]</td>
          <td>[60, 40, 30, 0]</td>
        </tr>
        <tr>
          <th>Missing completely at random</th>
          <td>2</td>
          <td>8</td>
          <td>[7, 6, 5, 6]</td>
          <td>[3, 4, 5, 4]</td>
          <td>[70, 60, 50, 60]</td>
          <td>[30, 40, 50, 40]</td>
        </tr>
        <tr>
          <th>Missing not at random</th>
          <td>2</td>
          <td>8</td>
          <td>[2, 3, 10, 5]</td>
          <td>[8, 7, 0, 5]</td>
          <td>[20, 30, 100, 50]</td>
          <td>[80, 70, 0, 50]</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 111-115

Step 5: Vary the missingness rate
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Next, we explore how patterns behave as we increase the percentage of incomplete samples. We amputate a
random multi-modal dataset under each mechanism at different missingness rates.

.. GENERATED FROM PYTHON SOURCE LINES 115-135

.. code-block:: Python


    n_mods = 5
    n_samples = 100
    Xs = [pd.DataFrame(np.random.default_rng(random_state).random((n_samples, 10))) for i in range(n_mods)]
    for p in np.arange(0.1, 1., 0.1):
        samples_dict = {}
        fig,axs = plt.subplots(1,4, figsize= (12,2.5))
        for idx, (ax, mechanism) in enumerate(zip(axs, list(mechanism_dict.keys()))):
            transformed_Xs = Amputer(mechanism=mechanism, p=p, random_state=random_state+1).fit_transform(Xs)
            fig, ax = plot_missing_modality(Xs=transformed_Xs, ax=ax)
            if p == 0.1:
                ax.set_title(mechanism_dict[mechanism])
            if idx != 0:
                ax.get_yaxis().set_visible(False)
            samples_dict[mechanism] = get_summary(Xs=transformed_Xs, one_row=True)
        plt.tight_layout()

        display(pd.DataFrame.from_dict(samples_dict, orient= "index"))





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_003.png
         :alt: Mutually exclusive missing, Partial missing, Missing completely at random, Missing not at random
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_004.png
         :alt: generate missing modalities
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_004.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_005.png
         :alt: generate missing modalities
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_005.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_006.png
         :alt: generate missing modalities
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_006.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_007.png
         :alt: generate missing modalities
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_007.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_008.png
         :alt: generate missing modalities
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_008.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_009.png
         :alt: generate missing modalities
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_009.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_010.png
         :alt: generate missing modalities
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_010.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_tutorials/images/sphx_glr_generate_missing_modalities_011.png
         :alt: generate missing modalities
         :srcset: /auto_tutorials/images/sphx_glr_generate_missing_modalities_011.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 90                  10          [92, 92, 92, 92, 92]              [8, 8, 8, 8, 8]            [92, 92, 92, 92, 92]                [8, 8, 8, 8, 8]
    pm                  90                  10        [96, 93, 100, 100, 93]              [4, 7, 0, 0, 7]          [96, 93, 100, 100, 93]                [4, 7, 0, 0, 7]
    mcar                90                  10          [94, 93, 95, 95, 94]              [6, 7, 5, 5, 6]            [94, 93, 95, 95, 94]                [6, 7, 5, 5, 6]
    mnar                90                  10          [92, 95, 95, 94, 97]              [8, 5, 5, 6, 3]            [92, 95, 95, 94, 97]                [8, 5, 5, 6, 3]
          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 80                  20          [84, 84, 84, 84, 84]         [16, 16, 16, 16, 16]            [84, 84, 84, 84, 84]           [16, 16, 16, 16, 16]
    pm                  80                  20        [100, 92, 100, 86, 88]            [0, 8, 0, 14, 12]          [100, 92, 100, 86, 88]              [0, 8, 0, 14, 12]
    mcar                80                  20          [86, 90, 88, 89, 87]         [14, 10, 12, 11, 13]            [86, 90, 88, 89, 87]           [14, 10, 12, 11, 13]
    mnar                80                  20          [85, 92, 97, 92, 88]            [15, 8, 3, 8, 12]            [85, 92, 97, 92, 88]              [15, 8, 3, 8, 12]
          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 70                  30          [76, 76, 76, 76, 76]         [24, 24, 24, 24, 24]            [76, 76, 76, 76, 76]           [24, 24, 24, 24, 24]
    pm                  70                  30        [87, 85, 100, 77, 100]           [13, 15, 0, 23, 0]          [87, 85, 100, 77, 100]             [13, 15, 0, 23, 0]
    mcar                70                  30          [81, 85, 83, 84, 83]         [19, 15, 17, 16, 17]            [81, 85, 83, 84, 83]           [19, 15, 17, 16, 17]
    mnar                70                  30          [84, 79, 88, 93, 86]          [16, 21, 12, 7, 14]            [84, 79, 88, 93, 86]            [16, 21, 12, 7, 14]
          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 60                  40          [68, 68, 68, 68, 68]         [32, 32, 32, 32, 32]            [68, 68, 68, 68, 68]           [32, 32, 32, 32, 32]
    pm                  60                  40        [78, 100, 100, 72, 84]           [22, 0, 0, 28, 16]          [78, 100, 100, 72, 84]             [22, 0, 0, 28, 16]
    mcar                60                  40          [77, 80, 79, 76, 78]         [23, 20, 21, 24, 22]            [77, 80, 79, 76, 78]           [23, 20, 21, 24, 22]
    mnar                60                  40          [82, 84, 70, 78, 92]          [18, 16, 30, 22, 8]            [82, 84, 70, 78, 92]            [18, 16, 30, 22, 8]
          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 50                  50          [60, 60, 60, 60, 60]         [40, 40, 40, 40, 40]            [60, 60, 60, 60, 60]           [40, 40, 40, 40, 40]
    pm                  50                  50        [70, 73, 76, 100, 100]           [30, 27, 24, 0, 0]          [70, 73, 76, 100, 100]             [30, 27, 24, 0, 0]
    mcar                50                  50          [72, 77, 77, 72, 70]         [28, 23, 23, 28, 30]            [72, 77, 77, 72, 70]           [28, 23, 23, 28, 30]
    mnar                50                  50         [72, 79, 50, 79, 100]          [28, 21, 50, 21, 0]           [72, 79, 50, 79, 100]            [28, 21, 50, 21, 0]
          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 40                  60          [52, 52, 52, 52, 52]         [48, 48, 48, 48, 48]            [52, 52, 52, 52, 52]           [48, 48, 48, 48, 48]
    pm                  40                  60        [61, 73, 69, 100, 100]           [39, 27, 31, 0, 0]          [61, 73, 69, 100, 100]             [39, 27, 31, 0, 0]
    mcar                40                  60          [67, 72, 72, 68, 66]         [33, 28, 28, 32, 34]            [67, 72, 72, 68, 66]           [33, 28, 28, 32, 34]
    mnar                40                  60          [62, 64, 64, 90, 76]         [38, 36, 36, 10, 24]            [62, 64, 64, 90, 76]           [38, 36, 36, 10, 24]
          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 30                  70          [44, 44, 44, 44, 44]         [56, 56, 56, 56, 56]            [44, 44, 44, 44, 44]           [56, 56, 56, 56, 56]
    pm                  30                  70        [100, 62, 65, 61, 100]           [0, 38, 35, 39, 0]          [100, 62, 65, 61, 100]             [0, 38, 35, 39, 0]
    mcar                30                  70          [64, 66, 64, 65, 61]         [36, 34, 36, 35, 39]            [64, 66, 64, 65, 61]           [36, 34, 36, 35, 39]
    mnar                30                  70          [65, 76, 73, 73, 49]         [35, 24, 27, 27, 51]            [65, 76, 73, 73, 49]           [35, 24, 27, 27, 51]
          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 20                  80          [36, 36, 36, 36, 36]         [64, 64, 64, 64, 64]            [36, 36, 36, 36, 36]           [64, 64, 64, 64, 64]
    pm                  20                  80        [100, 58, 58, 100, 57]           [0, 42, 42, 0, 43]          [100, 58, 58, 100, 57]             [0, 42, 42, 0, 43]
    mcar                20                  80          [61, 62, 61, 62, 52]         [39, 38, 39, 38, 48]            [61, 62, 61, 62, 52]           [39, 38, 39, 38, 48]
    mnar                20                  80          [34, 68, 82, 59, 68]         [66, 32, 18, 41, 32]            [34, 68, 82, 59, 68]           [66, 32, 18, 41, 32]
          Complete samples  Incomplete samples Observed samples per modality Missing samples per modality % Observed samples per modality % Missing samples per modality
    mem                 10                  90          [28, 28, 28, 28, 28]         [72, 72, 72, 72, 72]            [28, 28, 28, 28, 28]           [72, 72, 72, 72, 72]
    pm                  10                  90        [57, 48, 100, 100, 54]           [43, 52, 0, 0, 46]          [57, 48, 100, 100, 54]             [43, 52, 0, 0, 46]
    mcar                10                  90          [57, 56, 57, 58, 48]         [43, 44, 43, 42, 52]            [57, 56, 57, 58, 48]           [43, 44, 43, 42, 52]
    mnar                10                  90         [35, 64, 25, 64, 100]          [65, 36, 75, 36, 0]           [35, 64, 25, 64, 100]            [65, 36, 75, 36, 0]




.. GENERATED FROM PYTHON SOURCE LINES 136-141

Conclusion
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
While all the cases have the same number of complete and incomplete samples, each pattern represents a unique
distribution of missing data across different modalities, helping researchers to assess the robustness of
machine learning models in the presence of incomplete data.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 3.034 seconds)


.. _sphx_glr_download_auto_tutorials_generate_missing_modalities.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: generate_missing_modalities.ipynb <generate_missing_modalities.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: generate_missing_modalities.py <generate_missing_modalities.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: generate_missing_modalities.zip <generate_missing_modalities.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
